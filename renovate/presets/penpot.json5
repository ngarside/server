/*
	This is free and unencumbered software released into the public domain.

	This preset synchronises the version of all Penpot base images to the
	'penpotapp/backend' image. This is necessary to ensure that all running
	Penpot containers are of the same version, which prevents conflicts
	between incompatible versions.

	- https://hub.docker.com/r/penpotapp/backend
*/

{
	"$schema": "https://docs.renovatebot.com/renovate-schema.json",
	"customManagers": [
		{
			"customType": "regex",
			"datasourceTemplate": "docker",
			"depNameTemplate": "docker.io/penpotapp/backend",
			"managerFilePatterns": ["**/*.dockerfile"],
			"matchStrings": [
				"\\n\\s*FROM\\s*docker.io/penpotapp/[^:]+:(?<currentValue>[\\w\\.-]+)"
			]
		},
		{
			"customType": "regex",
			"datasourceTemplate": "docker",
			"depNameTemplate": "ghcr.io/ngarside/penpot-backend",
			"managerFilePatterns": ["**/*.container"],
			"matchStrings": [
				"\\n\\s*Image\\s*=\\s*ghcr.io/ngarside/penpot-[^:]+:(?<currentValue>[\\w\\.-]+)"
			]
		}
	],
	"packageRules": [
		{
			"commitMessageTopic": "{{{depName}}} tag",
			"matchDepNames": ["docker.io/penpotapp/backend", "ghcr.io/ngarside/penpot-backend"],
			"matchManagers": ["regex"]
		},
		{
			"enabled": false,
			"matchManagers": ["dockerfile"],
			"matchPackageNames": ["docker.io/penpotapp/*"]
		},
		{
			"enabled": false,
			"matchManagers": ["quadlet"],
			"matchPackageNames": ["ghcr.io/ngarside/penpot*"]
		}
	]
}
